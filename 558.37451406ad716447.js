"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[558],{8558:(ht,x,n)=>{n.r(x),n.d(x,{UserModule:()=>ft});var d=n(9808),b=n(3075),T=n(4371),A=n(5874),f=n(5415),y=n(5192),O=n(6448),p=n(8555),t=n(5e3),g=n(7204),u=n(5680),m=n(7901),h=n(419),U=n(3518),_=n(7781),L=(n(3320),n(8929));function I(i,a){1&i&&(t.TgZ(0,"tr"),t.TgZ(1,"td",6),t._uU(2,"Cargando informaci\xf3n..."),t.qZA(),t.qZA())}function D(i,a){1&i&&(t.TgZ(0,"tr"),t.TgZ(1,"td",6),t._uU(2,"No hay registros."),t.qZA(),t.qZA())}function M(i,a){1&i&&(t.TgZ(0,"span"),t._UZ(1,"i",12),t.qZA())}function S(i,a){1&i&&(t.TgZ(0,"span"),t._UZ(1,"i",13),t.qZA())}function Y(i,a){1&i&&(t.TgZ(0,"span"),t._UZ(1,"i",14),t.qZA())}function q(i,a){1&i&&(t.TgZ(0,"span"),t._UZ(1,"i",15),t.qZA())}function j(i,a){1&i&&t._UZ(0,"i",18)}function J(i,a){1&i&&t._UZ(0,"i",19)}function k(i,a){if(1&i&&(t.ynx(0),t.YNc(1,j,1,0,"i",16),t.YNc(2,J,1,0,"i",17),t.BQk()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",0==e.active),t.xp6(1),t.Q6J("ngIf",1==e.active)}}function P(i,a){1&i&&t._UZ(0,"i",22)}function Q(i,a){1&i&&t._UZ(0,"i",23)}function N(i,a){if(1&i&&(t.ynx(0),t.YNc(1,P,1,0,"i",20),t.YNc(2,Q,1,0,"i",21),t.BQk()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",0==e.active),t.xp6(1),t.Q6J("ngIf",1==e.active)}}function F(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr",7),t.TgZ(1,"td",2),t.YNc(2,M,2,0,"span",4),t.YNc(3,S,2,0,"span",4),t.YNc(4,Y,2,0,"span",4),t.YNc(5,q,2,0,"span",4),t.qZA(),t.TgZ(6,"td",8),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw().goDetailUser(l)}),t._uU(7),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"date"),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td",9),t.YNc(16,k,3,2,"ng-container",4),t.YNc(17,N,3,2,"ng-container",4),t.qZA(),t.TgZ(18,"td",10),t.TgZ(19,"i",11),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw().goDetailUser(l)}),t.qZA(),t.qZA(),t.qZA()}if(2&i){const e=a.$implicit,s=t.oxw();t.Q6J("ngClass",0==e.estado?"user-disabled":""),t.xp6(2),t.Q6J("ngIf",0==e.rol.tipo),t.xp6(1),t.Q6J("ngIf",1==e.rol.tipo),t.xp6(1),t.Q6J("ngIf",2==e.rol.tipo),t.xp6(1),t.Q6J("ngIf",3==e.rol.tipo),t.xp6(2),t.Oqu(e.nombre),t.xp6(2),t.Oqu(e.apellidos),t.xp6(2),t.Oqu(t.xi3(12,11,e.created_at,"dd-MM-yyyy")),t.xp6(3),t.Oqu(e.email),t.xp6(2),t.Q6J("ngIf",1==s.isAdmin),t.xp6(1),t.Q6J("ngIf",0==s.isAdmin)}}let C=(()=>{class i{constructor(e,s,o,l){this.router=e,this.storageService=s,this.usrSrv=o,this.utilsSrv=l,this.dtOptions={},this.dtTrigger=new L.xQ,this.listaUsuarios=[],this.nameDatatable="UserList",this.itemsPage=15,this.loading=!0}get isAdmin(){return this.storageService.isAdmin()}ngOnInit(){this.userLoad?(console.log(this.userLoad),this.dtOptions=this.optionsDatatableWithUser()):this.dtOptions=this.optionsDatatable()}ngOnDestroy(){this.dtTrigger.unsubscribe()}ngAfterViewInit(){const e=this;setTimeout(function(){e.dtTrigger.next(0)},200)}optionsDatatable(){const e=this;return{name:this.nameDatatable,order:[[3,"desc"]],columnDefs:[{orderable:!1,targets:[6]},{orderSequence:["desc","asc"],targets:[0,3]}],lengthChange:!1,searching:!0,searchDelay:750,pageLength:this.itemsPage,serverSide:!0,processing:!1,retrieve:!0,destroy:!0,deferRender:!0,initComplete:(s,o)=>{$("#"+this.nameDatatable).wrap("<div class='initComplete' style='overflow:auto; width:100%;position:relative;'></div>")},ajax:(s,o)=>{e.loading=!0;let r="created_at";switch(s.order[0].column){case 0:r="idRol";break;case 1:r="nombre";break;case 2:r="apellidos";break;case 3:default:r="created_at";break;case 4:r="email";break;case 5:r="active"}s.search.regex=!0;let Z=parseInt(s.start)/parseInt(s.length);e.usrSrv.getUsers(Z,s.length,r,s.order[0].dir,s.search.value).subscribe(c=>{e.listaUsuarios=c.result,o({recordsTotal:c.total,recordsFiltered:c.filter,data:[]}),c.total<=e.listaUsuarios.length||c.filter<=e.listaUsuarios.length?$(".dataTables_paginate").hide():$(".dataTables_paginate").show(),e.loading=!1},c=>{e.loading=!1})},headerCallback:(s,o,l,r,v)=>{},language:{url:this.utilsSrv.DatatablesFileLang()}}}optionsDatatableWithUser(){const e=this;return{name:this.nameDatatable,order:[[3,"desc"]],columnDefs:[{orderable:!1,targets:[6]},{orderSequence:["desc","asc"],targets:[0,3]}],lengthChange:!1,searching:!0,searchDelay:750,pageLength:this.itemsPage,serverSide:!0,processing:!1,retrieve:!0,destroy:!0,deferRender:!0,initComplete:(s,o)=>{$("#"+this.nameDatatable).wrap("<div class='initComplete' style='overflow:auto; width:100%;position:relative;'></div>")},ajax:(s,o)=>{e.loading=!0;let r="created_at";switch(s.order[0].column){case 0:r="idRol";break;case 1:r="nombre";break;case 2:r="apellidos";break;case 3:default:r="created_at";break;case 4:r="email";break;case 5:r="active"}s.search.regex=!0;let Z=parseInt(s.start)/parseInt(s.length);e.usrSrv.getUsersByUser(e.userLoad.id,Z,s.length,r,s.order[0].dir,s.search.value).subscribe(c=>{e.listaUsuarios=c.result,o({recordsTotal:c.total,recordsFiltered:c.filter,data:[]}),c.total<=e.listaUsuarios.length||c.filter<=e.listaUsuarios.length?$(".dataTables_paginate").hide():$(".dataTables_paginate").show(),e.loading=!1},c=>{e.loading=!1})},headerCallback:(s,o,l,r,v)=>{},language:{url:this.utilsSrv.DatatablesFileLang()}}}goDetailUser(e){console.log("goDetailUser"),this.router.navigate(["/users/detail/"+e.id])}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(p.F0),t.Y36(g.V),t.Y36(u.f),t.Y36(m.F))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-user-list"]],viewQuery:function(e,s){if(1&e&&t.Gf(f.G,5),2&e){let o;t.iGM(o=t.CRH())&&(s.datatableElement=o.first)}},inputs:{userLoad:"userLoad"},decls:22,vars:6,consts:[["datatable","",1,"display","nowrap","table","row-border","hover","stripe",2,"width","100% !important",3,"id","dtOptions","dtTrigger"],["userList",""],[1,"text-center"],[1,"text-right"],[4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],["colspan","7"],[3,"ngClass"],[1,"c-pointer",3,"click"],[1,"c-pointer-i","text-center"],[1,"c-pointer-i","text-right"],[1,"fas","fa-angle-double-right","text-primary","fa-lg","pl-3",3,"click"],[1,"fa","fa-user","text-primary","fa-lg"],[1,"fas","fa-user-shield","fa-lg"],[1,"fas","fa-users","text-danger","fa-lg"],[1,"fa","fa-users-cog","text-success","fa-lg"],["class","fas fa-toggle-off fa-lg  text-danger",4,"ngIf"],["class","fas fa-toggle-on fa-lg  text-primary",4,"ngIf"],[1,"fas","fa-toggle-off","fa-lg","text-danger"],[1,"fas","fa-toggle-on","fa-lg","text-primary"],["class","far fa-times-circle fa-lg  text-danger",4,"ngIf"],["class","far fa-check-circle fa-lg  text-primary",4,"ngIf"],[1,"far","fa-times-circle","fa-lg","text-danger"],[1,"far","fa-check-circle","fa-lg","text-primary"]],template:function(e,s){1&e&&(t.TgZ(0,"table",0,1),t.TgZ(2,"thead"),t.TgZ(3,"tr"),t.TgZ(4,"th",2),t._uU(5,"#"),t.qZA(),t.TgZ(6,"th"),t._uU(7,"Nombre"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Apellidos"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Fecha alta"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"C. electr\xf3nico"),t.qZA(),t.TgZ(14,"th",2),t._uU(15,"Activado?"),t.qZA(),t.TgZ(16,"th",3),t._uU(17,"Acciones"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(18,"tbody"),t.YNc(19,I,3,0,"tr",4),t.YNc(20,D,3,0,"tr",4),t.YNc(21,F,20,14,"tr",5),t.qZA(),t.qZA()),2&e&&(t.Q6J("id",s.nameDatatable)("dtOptions",s.dtOptions)("dtTrigger",s.dtTrigger),t.xp6(19),t.Q6J("ngIf",s.loading),t.xp6(1),t.Q6J("ngIf",0==s.loading&&0==s.listaUsuarios.length),t.xp6(1),t.Q6J("ngForOf",s.listaUsuarios))},directives:[f.G,d.O5,d.sg,d.mk],pipes:[d.uU],styles:["table.dataTable td.dataTables_empty{display:none}.user-disabled[_ngcontent-%COMP%]{background-color:#ff00333d}"]}),i})();function w(i,a){1&i&&(t.TgZ(0,"div",5),t.TgZ(1,"div",6),t._uU(2,"Nuevo usuario "),t._UZ(3,"i",7),t.qZA(),t.qZA())}let V=(()=>{class i{constructor(e,s,o,l){this.router=e,this.storageService=s,this.usrSrv=o,this.utilsSrv=l}get isAdmin(){return this.storageService.isAdmin()}ngOnInit(){this.storageService.setBreadCrumbUrl("users/list","Gesti\xf3n de usuarios")}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(p.F0),t.Y36(g.V),t.Y36(u.f),t.Y36(m.F))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-page-users-list"]],decls:11,vars:2,consts:[[1,"container-fluid","pt-3","pl-0","pr-0","espace"],[1,"col-12","col-xl-12","col-lg-12",2,"display","block"],[1,"row"],[3,"ngClass"],["class","col-6 c-pointer text-right",4,"ngIf"],[1,"col-6","c-pointer","text-right"],[1,"btn","btn-primary","btn-sm"],[1,"fas","fa-user-plus","fa-sm"]],template:function(e,s){1&e&&(t._UZ(0,"app-breadcrumb"),t.TgZ(1,"div",0),t.TgZ(2,"app-block-group-dashboard"),t.TgZ(3,"div",1),t.TgZ(4,"app-block-dashboard"),t.TgZ(5,"div",2),t.TgZ(6,"div",3),t.TgZ(7,"h2"),t._uU(8,"Listado de usuarios"),t.qZA(),t.qZA(),t.YNc(9,w,4,0,"div",4),t.qZA(),t._UZ(10,"app-user-list"),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(6),t.Q6J("ngClass",s.isAdmin?"col-6":"col-12"),t.xp6(3),t.Q6J("ngIf",s.isAdmin))},directives:[h.L,U.q,_.o,d.mk,d.O5,C],styles:["table.dataTable td.dataTables_empty{display:none}.table[_ngcontent-%COMP%], .black[_ngcontent-%COMP%]{color:#000!important}.icon-black[_ngcontent-%COMP%]{background-color:#fff!important;color:#000!important}.mat-icon-button[_ngcontent-%COMP%]{background-color:#0000;border:0px;color:#707070}.grid-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:flex-end;height:auto}.grid-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:relative;float:right}@media (max-width: 510px){.grid-container[_ngcontent-%COMP%]{justify-content:space-evenly!important}}.end[_ngcontent-%COMP%]{align-self:flex-end}.example-container[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%] + .mat-form-field[_ngcontent-%COMP%]{margin-left:8px}.example-right-align[_ngcontent-%COMP%]{text-align:right}input.example-right-align[_ngcontent-%COMP%]::-webkit-outer-spin-button, input.example-right-align[_ngcontent-%COMP%]::-webkit-inner-spin-button{display:none}input.example-right-align[_ngcontent-%COMP%]{-moz-appearance:textfield}.my-fab2[_ngcontent-%COMP%]{width:40px;height:40px;line-height:18px;font-size:18px;background-color:#000!important}.my-fab2[_ngcontent-%COMP%]  .mat-button-wrapper{line-height:18px;padding:0}.my-fab2[_ngcontent-%COMP%]  .mat-button-wrapper .mat-icon{font-size:18px;margin-top:5px;color:#fff}.my-fab[_ngcontent-%COMP%]{width:50px;height:50px;line-height:26px;font-size:26px;background-color:#fff!important}.my-fab[_ngcontent-%COMP%]  .mat-button-wrapper{line-height:26px;padding:0}.my-fab[_ngcontent-%COMP%]  .mat-button-wrapper .mat-icon{font-size:26px}"]}),i})();var B=n(8146);function z(i,a){1&i&&(t.TgZ(0,"div",6),t.TgZ(1,"div",7),t._uU(2,"Editar usuario "),t._UZ(3,"i",8),t.qZA(),t.qZA())}function G(i,a){if(1&i&&t._UZ(0,"app-viajes-list",10),2&i){const e=t.oxw(3);t.Q6J("id",e.id)}}function R(i,a){if(1&i&&(t.TgZ(0,"app-block-dashboard"),t.YNc(1,G,1,1,"app-viajes-list",9),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.id)}}function X(i,a){if(1&i&&(t.TgZ(0,"app-block-dashboard"),t.TgZ(1,"div",3),t.TgZ(2,"div",11),t.TgZ(3,"h2"),t._uU(4,"Gesti\xf3n de usuarios"),t.qZA(),t.qZA(),t.qZA(),t._UZ(5,"app-user-list",12),t.qZA()),2&i){const e=t.oxw(2);t.xp6(5),t.Q6J("userLoad",e.user)}}function K(i,a){if(1&i&&(t.TgZ(0,"app-block-group-dashboard"),t.TgZ(1,"div",2),t.TgZ(2,"app-block-dashboard"),t.TgZ(3,"div",3),t.TgZ(4,"div",4),t.TgZ(5,"h2"),t._uU(6),t.qZA(),t.qZA(),t.YNc(7,z,4,0,"div",5),t.qZA(),t.qZA(),t.YNc(8,R,2,1,"app-block-dashboard",1),t.YNc(9,X,6,1,"app-block-dashboard",1),t.qZA(),t.qZA()),2&i){const e=t.oxw();t.xp6(4),t.Q6J("ngClass",1==e.isAdmin?"col-6":"col-12"),t.xp6(2),t.AsE("Detalle de ",e.user.nombre," ",e.user.apellidos,""),t.xp6(1),t.Q6J("ngIf",e.isAdmin),t.xp6(1),t.Q6J("ngIf",e.user),t.xp6(1),t.Q6J("ngIf",e.user&&(2==e.user.rol.tipo||3==e.user.rol.tipo))}}let E=(()=>{class i{constructor(e,s,o,l){this.storageService=e,this.utilsSrv=s,this.usrSrv=o,this.route=l}ngOnInit(){this.storageService.setBreadCrumbUrl("users/list","Gesti\xf3n de usuarios"),console.log("Detalle"),this.route.params.subscribe(e=>{this.id=e.id,console.log("Load "+this.id),this.loadUser(this.id)})}get isAdmin(){return this.storageService.isAdmin()}loadUser(e){this.user=null,console.log("loadUser: ",e),this.usrSrv.getUserDetail(e).subscribe(s=>{"OK"==s.status&&(this.user=s.result,this.storageService.addBreadCrumb("users/detail/"+this.user.id,this.user.nombre+" "+this.user.apellidos))})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(g.V),t.Y36(m.F),t.Y36(u.f),t.Y36(p.gz))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-page-user-detail"]],decls:3,vars:1,consts:[[1,"container-fluid","pt-3","pl-0","pr-0","espace"],[4,"ngIf"],[1,"col-12","col-xl-12","col-lg-12",2,"display","block"],[1,"row"],[3,"ngClass"],["class","col-6 c-pointer text-right",4,"ngIf"],[1,"col-6","c-pointer","text-right"],[1,"btn","btn-warning","btn-sm"],[1,"fas","fa-user-edit","fa-sm"],[3,"id",4,"ngIf"],[3,"id"],[1,"col-12"],[3,"userLoad"]],template:function(e,s){1&e&&(t._UZ(0,"app-breadcrumb"),t.TgZ(1,"div",0),t.YNc(2,K,10,6,"app-block-group-dashboard",1),t.qZA()),2&e&&(t.xp6(2),t.Q6J("ngIf",s.user))},directives:[h.L,d.O5,U.q,_.o,d.mk,B.b,C],styles:[""]}),i})();var H=n(1946),W=n(8367),tt=n(9009);function et(i,a){if(1&i&&t._UZ(0,"app-mapa",8),2&i){const e=t.oxw();t.Q6J("viaje",e.viaje)("direct",!0)}}const it=[{path:"",children:[{path:"list",component:V},{path:"detail/:id",component:E},{path:"detail/:id/viaje/:idViaje",component:(()=>{class i{constructor(e,s,o,l){this.storageService=e,this.usrSrv=s,this.route=o,this.darpService=l,this.loading=!0,this.id=this.route.snapshot.paramMap.get("idViaje"),this.idUser=parseInt(this.route.snapshot.paramMap.get("id")),this.viaje=new H.F}ngOnInit(){this.loading=!0,this.storageService.setBreadCrumbUrl("users/list","Gesti\xf3n de usuarios"),this.loadUser(this.idUser),this.darpService.getViaje(parseInt(this.id)).subscribe(e=>{"OK"==e.status&&e.result.registros.length>0&&(this.viaje=e.result),this.loading=!1})}loadUser(e){this.user=null,console.log("loadUser: ",e),this.usrSrv.getUserDetail(e).subscribe(s=>{"OK"==s.status&&(this.user=s.result,this.storageService.addBreadCrumb("users/detail/"+this.idUser,this.user.nombre+" "+this.user.apellidos),this.storageService.addBreadCrumb("users/detail/"+this.idUser+"/viajes","Detalle viaje #"+this.id))})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(g.V),t.Y36(u.f),t.Y36(p.gz),t.Y36(W.S))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-page-user-viaje-detail"]],decls:9,vars:1,consts:[[1,"container-fluid","pt-3","pl-0","pr-0"],[1,"container-fluid","pl-0","pr-0"],[1,"col-12","main"],[1,"row"],[1,"col-12","mb-3",2,"display","block"],[1,"card"],[1,"card-body",2,"border","1px solid #c8ced3 !important","border-radius","0.375rem"],[3,"viaje","direct",4,"ngIf"],[3,"viaje","direct"]],template:function(e,s){1&e&&(t._UZ(0,"app-breadcrumb"),t.TgZ(1,"div",0),t.TgZ(2,"div",1),t.TgZ(3,"div",2),t.TgZ(4,"div",3),t.TgZ(5,"div",4),t.TgZ(6,"div",5),t.TgZ(7,"div",6),t.YNc(8,et,1,2,"app-mapa",7),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(8),t.Q6J("ngIf",0==s.loading))},directives:[h.L,d.O5,tt.N],styles:[""]}),i})()}]}];let st=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[p.Bz.forChild(it)],p.Bz]}),i})();var at=n(7021),nt=n(6201),rt=n(1223),ot=n(6766),lt=n(1279),ct=n(8341),dt=n(1377),pt=n(3305),gt=n(5226),ut=n(2211);let ft=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[d.ez,st,b.u5,b.UX,y.CH,A.IJ,T.SJ,O.AdminLayoutModule,f.T,nt.XK,at.FA,rt.lN,ot.c,lt.Ps,ct.Is,dt.ot,pt.su,gt.KP,ut.ZX]]}),i})()}}]);